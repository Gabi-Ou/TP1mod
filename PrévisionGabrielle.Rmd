---
title: "ModGabrielle"
author: "Gabrielle Ouellet"
date: "2022-10-31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Corrections:
```{r}
Original <- read.csv('MontantReclFr.csv')
x <- read.csv('MontantReclFr.csv')
attach(x)

mont_recl[mont_recl == -7682.59] <- 7682.59
x[age_veh > 20, ]$age_veh <- NA
x[bonus_malus < 50 | bonus_malus >= 350, ]$bonus_malus <- NA
genre_2 <- sub("femme", "Femme", genre)
genre <- factor(genre_2)
stat_matri <- factor(stat_matri)
categ_socio <- factor(categ_socio)
usage_veh <- factor(usage_veh)
type_veh <- factor(type_veh)
garage <- factor(garage)
source_energ <- factor(source_energ)
```
Le jeu de données a la structure suivante:
```{r}
library(ggplot2)
library(ISLR)
str(x)
```
Contenu des données:
```{r}
summary(x)
```

##### Nuages de points de la variable réponse en fonction de chacune des variables explicatives continues:
```{r paires}
pairs(mont_recl~age_permi + age_veh + genre + categ_socio + usage_veh + age_conduct + type_veh + bonus_malus + garage + source_energ + I(log(valeur_veh)))
```

##### Ajuster un modèle de régression linéaire multiple pour la variable mont_recl en fonction de toutes les variables explicatives
```{r}
mod.complet <- lm(mont_recl~age_permi + age_veh + genre + categ_socio + usage_veh + age_conduct + type_veh + bonus_malus + garage + source_energ + I(log(valeur_veh)))
summary(mod.complet)
```

##### On peut extraire bêta 1 et bêta 2 (associés à age_permi et à age_veh) ainsi:
Cela signifie que lorsqu’un permis a une année de plus, sans changement aux autres variables explicatives, la moyenne de ses réclamations mont_recl diminue de 3.87 dollars, et lorsqu'un véhicule a une année de plus, on augmente son montant de réclamation de 39.33 dollars. On peut faire ceci avec toutes les autres variables.
```{r}
(coef_age_permi <- mod.complet$coefficients[1 + 1])
(coef_age_veh <- mod.complet$coefficients[2 + 1])
```

##### Intervalle de confiance à 95% pour bêta 2 (age_veh):
```{r}
confint(mod.complet, 
        parm = 1 + 1,
        level = 0.95)
confint(mod.complet, 
        parm = 2 + 1,
        level = 0.95)
```
Puisqu'il s'agit de très grands intervalles, notre modèle n'est pas très bon.


##### Test t pour vérifier si le nombre d'années supplémentaires du véhicule a un effet significatif sur le montant de réclamation. Utiliser un seuil de signification de 1%.

On commence par énoncer les hypothèses : <br/>
$H_0$ : `age_permi` n'est pas significative $(\beta_{2} = 0)$ <br/>
$H_1$ : `age_permi` est significative $(\beta_{2} \ne 0)$ <br/>

$H_0$ : `age_veh` n'est pas significative $(\beta_{2} = 0)$ <br/>
$H_1$ : `age_veh` est significative $(\beta_{2} \ne 0)$ <br/>

On peut ensuite utiliser directement les valeurs données par `R`.

```{r}
summary(mod.complet)$coefficients[1 + 1,]
summary(mod.complet)$coefficients[2 + 1,]
```

Le seuil observé $p=$ 44,23\% pour ce test est plus élevé que notre seuil de signification de 1\%. Nous ne sommes donc pas en mesure de rejeter l'hypothèse nulle stipulant que le dit coefficient est nul pour un seuil de signification de 1\%. Il serait donc approprié d'ajuster un nouveau modèle sans cette variable.

Le seuil observé $p=$ 7,05\% pour ce test est plus élevé que notre seuil de signification de 1\%. Nous ne sommes donc pas en mesure de rejeter l'hypothèse nulle stipulant que le dit coefficient est nul pour un seuil de signification de 1\%. Il serait donc approprié d'ajuster un nouveau modèle sans cette variable.


##### Prévisions
On s'intéresse à un individu avec les caractéristiques suivantes:
```{r}
(x0 <- x[1,2:14])
```

##### Prévision ponctuelle
Quelle est la prévision ponctuelle du solde pour un individu avec ces caractéristiques?
```{r}
predict(mod.complet, newdata = x0)
```


##### I.C 99% pour le solde moyen d’un individu avec ces caractéristiques

```{r}
predict(mod.complet, newdata = x0,
        level = 0.99,
        interval = "confidence")
```

Moyenne (I.C. plus petit car variance moyenne plus petite)


##### I.C. 99% pour la prévision du solde d’un individu avec ces  caractéristiques
```{r}
predict(mod.complet, newdata = x0,
        level = 0.99,
        interval = "prediction")
```

Prévision (intervalle de confiance plus grand car variance individuelle plus grande).


##### Tests de réduction du modèle